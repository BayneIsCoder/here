<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Here: Web Edition</title>
  <style>
    body {
      background: #0d1117;
      color: #c9d1d9;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    h1 { color: #58a6ff }
    input, select, button {
      margin: 0.5rem;
      padding: 0.5rem;
      background: #161b22;
      border: 1px solid #30363d;
      color: #c9d1d9;
      border-radius: 4px;
    }
    button {
      background: #238636;
      cursor: pointer;
    }
    pre {
      background: #161b22;
      padding: 1rem;
      border-radius: 4px;
      margin-top: 1rem;
      width: 90%;
      max-width: 700px;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <h1>Here: Web Edition</h1>
  <div>
    <select id="mode">
      <option value="eng_to_here">English to Here</option>
      <option value="here_to_eng">Here to English</option>
    </select>
    <input id="input" placeholder="Enter text..." />
    <button onclick="translate()">Translate</button>
    <button onclick="copyOutput()">Copy Result</button>
  </div>
  <pre id="output"></pre>

  <script>
    const map = {
      A: "ghc", B: "qzr", C: "vnt", D: "lxm", E: "kto", F: "dru",
      G: "wye", H: "bsa", I: "nem", J: "uxp", K: "miv", L: "jrk",
      M: "tah", N: "oec", O: "spg", P: "xdb", Q: "zyl", R: "fcu",
      S: "nid", T: "akj", U: "rbo", V: "hqn", W: "cme", X: "ibe",
      Y: "ztu", Z: "ylg"
    };
    const reverseMap = Object.fromEntries(Object.entries(map).map(([k, v]) => [v, k]));

    function translate() {
      const input = document.getElementById("input").value;
      const mode = document.getElementById("mode").value;
      let output = "";

      if (mode === "eng_to_here") {
        for (let ch of input) {
          if (/[a-zA-Z]/.test(ch)) {
            const upper = ch.toUpperCase();
            const code = map[upper];
            const suffix = ch === upper ? "1" : "0";
            output += code + suffix;
          }
        }
      } else {
        if (input.length % 4 !== 0) {
          output = "Invalid input length. Must be multiple of 4.";
        } else {
          const chunks = input.match(/.{4}/g);
          output = "";
          for (let chunk of chunks) {
            const code = chunk.slice(0, 3);
            const flag = chunk[3];
            const letter = reverseMap[code];
            if (!letter || !["0", "1"].includes(flag)) {
              output = "Invalid Here code found.";
              break;
            }
            output += flag === "1" ? letter : letter.toLowerCase();
          }
        }
      }

      document.getElementById("output").textContent = output;
    }

    function copyOutput() {
      const output = document.getElementById("output").textContent;
      navigator.clipboard.writeText(output).then(() => {
        alert("Copied to clipboard!");
      });
    }
  </script>
</body>
</html>
